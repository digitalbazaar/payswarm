<!DOCTYPE html> 
<html> 
  <head> 
    <title>Payswarm - Web API</title> 
    <meta http-equiv='Content-Type' content='text/html;charset=utf-8'/> 
    <!-- 
      === NOTA BENE ===
      For the three scripts below, if your spec resides on dev.w3 you can check them
      out in the same tree and use relative links so that they'll work offline,
     --> 
    <script src='http://dev.w3.org/2009/dap/ReSpec.js/js/respec.js' class='remove'></script> 
    <script class='remove'> 
      var respecConfig = {
          // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
          specStatus:           "unofficial",
          
          // the specification's short name, as in http://www.w3.org/TR/short-name/
          shortName:            "payswarm-web-api",
 
          // if you wish the publication date to be other than today, set this
          // publishDate:  "2009-08-06",
 
          // if there is a previously published draft, uncomment this and set its YYYY-MM-DD date
          // and its maturity status
          // previousPublishDate:  "1977-03-15",
          // previousMaturity:  "WD",
 
          // if there a publicly available Editor's Draft, this is the link
          edDraftURI:           "http://payswarm.com/specs/payswarm-web-api.html",
 
          // if this is a LCWD, uncomment and set the end of its review period
          // lcEnd: "2009-08-05",
 
          // if you want to have extra CSS, append them to this list
          // it is recommended that the respec.css stylesheet be kept
          extraCSS:             ["http://dev.w3.org/2009/dap/ReSpec.js/css/respec.css"],
 
          // editors, add as many as you like
          // only "name" is required
          editors:  [
              { name: "Manu Sporny", url: "http://digitalbazaar.com/",
                company: "Digital Bazaar, Inc.", companyURL: "http://digitalbazaar.com/" },
          ],
 
          // authors, add as many as you like. 
          // This is optional, uncomment if you have authors as well as editors.
          // only "name" is required. Same format as editors.
 
          //authors:  [
          //    { name: "Your Name", url: "http://example.org/",
          //      company: "Your Company", companyURL: "http://example.com/" },
          //],
          additionalCopyrightHolders: "Copyright 2009-2010 &copy; Digital Bazaar, Inc.",
          
          // name of the WG
          wg:           "Unofficial Payswarm Exploratory Group",
          
          // URI of the public WG page
          wgURI:        "http://payswarm.com/",
          
          // name (with the @w3c.org) of the public mailing to which comments are due
          wgPublicList: "---",
          
          // URI of the patent status for this WG, for Rec-track documents
          // !!!! IMPORTANT !!!!
          // This is important for Rec-track documents, do not copy a patent URI from a random
          // document unless you know what you're doing. If in doubt ask your friendly neighbourhood
          // Team Contact.
          wgPatentURI:  "",
      };
    </script> 
  </head> 
  <body> 
    <section id='abstract'> 
      <p> 
This document defines a set of REST Web APIs to enable the legal transfer of 
commercialized digital content. These APIs enable new Web-based 
business models by specifying methods of interaction between user agents and 
web servers to exchange digital goods and ensure the subequent distribution of 
monetary compensation to the content distributors and rights holders.
      </p> 
    </section> 

    <section>
      <h2>Introduction</h2>
      <p>
      </p>
    </section>

    <section>
      <h2>Network Participants</h2>
      <p>
      </p>
    </section>

    <section>
      <h2>Content Transaction Overview</h2>
      <p>
      </p>
    </section>

    <section>
      <h2>Base Technologies</h2>
      <p>
      </p>

      <section>
        <h3>REST</h3>
        <p>
        </p>
      </section>

      <section>
        <h3>Javascript Object Notation</h3>
        <p>
        </p>
      </section>

      <section>
        <h3>AES Cryptography Suite</h3>
        <p>
        </p>
      </section>

      <section>
        <h3>RDFa</h3>
        <p>
        </p>
      </section>
    </section>

    <section>
      <h2>Discovery</h2>
      <p>
      </p>

      <section>
      <h3>API Discovery</h3>
      <p>
      </p>
      </section>

      <section>
      <h3>Content Discovery</h3>
      <p>
      </p>
      </section>
    </section>

    <section>
      <h2>The Purchase Process</h2>
      <p>
This section describes the media discovery, license acquisition, contract
drafting, negotiating, data transfer, payment and file assembly process in
detail.
      </p>
      
      <section>
        <h3>Media Discovery</h3>
<ul> 
<li>Buyer finds the Media they want to purchase.
<ul> 
<li>Media can be found on a digital content sales website encoded in RDFa, in a file recognized by the browser as a media description, or anywhere else on the web.</li> 
<li>Digitally signed media could be found, in the future, by multicast (or other broadcast-like method) via peers on the network.</li> 
</ul> 
</li> 
</ul> 
      </section>

      <section>
        <h3>License Selection</h3>
<ul> 
<li>Current implementation includes license information in the Media object. Future implementations may split these two apart.</li> 
<li>PaySwarm Authority must digitally sign the Media so the Buyer can purchase it later. Sellers may also elect to reject negotiation attempts with them if the associated Media is not already signed.</li> 
</ul> 
      </section>

      <section>
        <h3>Asserting Purchase Preferences</h3>
<ul> 
<li>Buyer selects from the available options their preferred media file format, number of sellers, particular sellers, type of purchase (PeerBuy vs. WebBuy), etc.</li> 
<li>May include purchase amount, minimum download rate, guaranteed streaming rate, and account ID but doesn't need to. This can be specified at the time of purchase.</li> 
</ul> 
      </section>

      <section>
        <h3>Creating a Ware Bundle</h3>
<ul> 
<li>The media and files to be purchased are added to a WareBundle.
</ul> 
      </section>

      <section>
        <h3>Brokering a Non-Swarming Contract</h3>
<ul>
<li>Note: Used primarily for non-PaySwarming-aware Web browser based purchases (for old browsers).</li>
<li>Website sends the Contract to the Broker, which broker's a contract on behalf of the Buyer.</li>
<li>The Broker handles negotiating with 1 Seller, which is usually the Website.</li>
</ul>
      </section>

      <section>
        <h3>Brokering a Swarming Contract</h3>
<ul> 
<li>A WareBundle is constructed by the Buyer, using the Media and PurchasePreferences extracted from RDFa or other semantic markup on the page, or auto-generated by the User Agent.</li> 
<li>A number of Sellers are selected by the Buyer based on the PurchasePreferences.</li>
</ul> 
      </section>

      <section>
        <h3>Negotiating with a Seller</h3>
<ul> 
<li>Note: A Broker may act on behalf of a Buyer.</li> 
<li>Buyer creates a ContractSection with favorable or default terms.</li> 
<li>Buyer sends the Contract with the single ContractSection to the Seller.</li> 
<li>ContractSection contains a Ware that the Seller is expected to be selling.
<ul> 
<li>In the case of a ware bundle in PeerBuy, multiple wares may be constructed from the bundle, if for instance it contained an audio album with X songs. Each song would be negotiated for separately, but would include the License from the album.</li> 
</ul> 
</li> 
<li>Seller receives the Contract which includes the negotiated ContractSection.</li> 
<li>Seller optionally checks the Contract's Media License for the PaySwarm Authority's digital signature.
<ul> 
<li>If the signature fails, the Seller may simply deny the negotiation request. The seller may also allow it to proceed if they trust the buyer enough to assume the buyer will get a signature later and will not have wasted the seller's bandwidth for downloading an encrypted piece.</li> 
</ul> 
</li> 
<li>Seller adjusts the ContractSection according to their terms.
<ul> 
<li>EDITORS NOTE: Add details about signing algorithm, explain how cheating is avoided by signing particular fields.</li> 
</ul> 
</li> 
<li>Seller digitally signs the ContractSection establishing non-repudiation and implicitly agreeing to any terms they set forth.</li> 
<li>For Swarm-based purchases, Seller adds the signature, their profile ID, and a SwarmingPurchaseKey to the ContractSection that the buyer uses to authorize downloading FilePieces from the Seller.</li> 
<li>Seller returns the updated Contract w/ContractSection.</li> 
<li>If the buyer agrees to the Seller's terms, they will also sign the ContractSection.</li> 
</ul> 
      </section>

      <section>
        <h3>Downloading a FilePiece</h3>
<ul> 
<li>Buyer's sends, to the Seller, the ContractSection hash, the file ID, the media ID, the index of the FilePiece, the standard FilePiece size, the peerbuyKey, the ID of the Profile the Seller used to sign the ContractSection, and the ID of the Binary File Processor the Seller must use.</li> 
<li>Seller ensures the ContractSection hash and SwarmingPurchaseKey are valid.</li> 
<li>Seller loads the appropriate Binary File Processor.</li> 
<li>Seller begins streaming the FilePiece through the Binary File Processor to the Buyer.</li> 
<li>Binary File Processor generates a unique PieceKey and OpenKey.
<ul> 
<li>The PieceKey is used to encrypt the FilePiece data.</li> 
<li>The OpenKey is used to encrypt the PieceKey.
<ul> 
<li>The OpenKey is itself encrypted with a PublicKey unique to the Seller, whose PrivateKey pair is stored on the PaySwarm Authority.</li> 
<li>Only the PaySwarm Authority can unlock the OpenKey, which in turn, means only the PaySwarm Authority can unlock the PieceKey.</li> 
<li>FIXME: It seems this could be optimized to just locking the PieceKey with the PublicKey... and perhaps wasn't done this way due to some limitation with OpenSSL's API.</li> 
</ul> 
</li> 
</ul> 
</li> 
<li>Binary File Processor signs FilePiece information.</li> 
<li>Seller sends actual FilePiece size, the Binary File Processor's signature on the FilePiece, the Seller's profile ID and signature on the FilePiece, the encrypted PieceKey, and the encrypted OpenKey to the Buyer.
<ul> 
<li>EDITORS NOTE: Add details about what is signed on a FilePiece and why, explain how cheating is avoided by signing particular fields</li> 
</ul> 
</li> 
</ul> 
      </section>

      <section>
        <h3>Purchasing the License</h3>
<ul> 
<li>Buyer sends the Contract with the Media License to the PaySwarm Authority.</li> 
<li>PaySwarm Authority checks the signature on the Media License.</li> 
<li>PaySwarm Authority moves money from the Buyer's account to the accounts specified in the License.</li> 
</ul> 
      </section>

      <section>
        <h3>Purchasing the Data</h3>
<ul> 
<li>Buyer sends a ContractSection with N FilePieces to the PaySwarm Authority.</li> 
<li>The PaySwarm Authority verifies the Seller and Buyer signatures on the ContractSection and the Seller and Binary File Processor signatures on the FilePieces.</li> 
<li>The PaySwarm Authority moves money from the Buyer's account to the accounts specified in the ContractSection.
<ul> 
<li>EDITORS NOTE: Add details on how payment amounts are determined</li> 
</ul> 
</li> 
<li>The PaySwarm Authority unlocks each FilePiece PieceKey.</li> 
<li>The PaySwarm Authority returns the FilePieces with unlocked PieceKeys to the Buyer.</li> 
</ul> 
      </section>
      
      <section>
        <h3>Assembling the Data</h3>
<ul> 
<li>Buyer loads the Binary File Processor with the appropriate ID.</li> 
<li>Buyer streams the encrypted FilePieces with unlocked PieceKeys through the Binary File Processor.</li> 
<li>Binary File Processor outputs assembled file(s).</li>
<li>EDITORS NOTE: Add details on Binary File Processor checking/reporting bad sellers (sellers that failed to use Binary File Processors correctly)</li> 
      </section>
    </section>
    
    <section>
      <h2>Security Concerns</h2>
      <p>
      </p>

      <section>
        <h3>Identity Management</h3>
        <p>
        </p>
      </section>

      <section>
        <h3>Digital Signatures</h3>
        <p>
        </p>
      </section>

      <section>
        <h3>Encryption and Decryption</h3>
        <p>
        </p>
      </section>

      <section>
        <h3>Identifying and Removing Troublemakers</h3>
        <p>
        </p>
      </section>

      <section>
        <h3>Halting Content Distribution</h3>
        <p>
        </p>
      </section>
    </section>

    <section>
      <h2>API Reference</h2>

      @PAYSWARM_API_REFERENCE@

    </section>

  </body> 
</html>

